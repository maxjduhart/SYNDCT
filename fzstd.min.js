!function(r){"undefined"!=typeof module&&"object"==typeof exports?module.exports=r():"undefined"!=typeof define&&define.amd?define(r):("undefined"==typeof self?this:self).fzstd=r()}(function(){function E(r,t,e){if(S.prototype.slice)return S.prototype.slice.call(r,t,e);(null==t||t<0)&&(t=0),(null==e||e>r.length)&&(e=r.length);var n=new S(e-t);return n.set(r.subarray(t,e)),n}function T(r,t,e,n){if(S.prototype.fill)return S.prototype.fill.call(r,t,e,n);for((null==e||e<0)&&(e=0),(null==n||n>r.length)&&(n=r.length);e<n;++e)r[e]=t;return r}function f(r,t,e,n){if(S.prototype.copyWithin)return S.prototype.copyWithin.call(r,t,e,n);for((null==e||e<0)&&(e=0),(null==n||n>r.length)&&(n=r.length);e<n;)r[t++]=r[e++]}function u(r,t,e){for(var n=0,s=0;n<e;++n)s|=r[t++]<<(n<<3);return s}function a(r,t){if(3126568!=(s=r[0]|r[1]<<8|r[2]<<16)||253!=r[3])return 25481893==(s>>4|r[3]<<20)?8+((r[4]|r[5]<<8|r[6]<<16|r[7]<<24)>>>0):void D(0);var e=r[4],n=1&e>>5,s=1&e>>2,i=3&e,o=e>>6;8&e&&D(0);var f=3==i?4:i,a=(i=u(r,e=6-n,f),o?1<<o:n),o=f=u(r,e+=f,a)+(1==o&&256);return n||(o=(n=1<<10+(r[5]>>3))+(n>>3)*(7&r[5])),2145386496<o&&D(1),(n=new S((1==t?f||o:t?0:o)+12))[0]=1,n[4]=4,n[8]=8,{b:e+a,y:0,l:0,d:i,w:t&&1!=t?t:n.subarray(12),e:o,o:new b(n.buffer,0,3),u:f,c:s,m:Math.min(131072,o)}}function k(r){for(var t=0;1<<t<=r;++t);return t-1}function B(r,t,e){var n=4+(t<<3);e<(t=5+(15&r[t]))&&D(3);for(var s=e=1<<t,i=-1,o=e,f=new g(512+(e<<2)),a=new v(f,0,256),u=new x(f,0,256),h=new x(f,512,e),l=512+(e<<1),b=new S(f,l,e),f=new S(f,l+e);i<255&&0<s;){var y=n>>3,c=(1<<(l=k(s+1))+1)-1,p=(1<<l)-1,w=(y=(r[y]|r[y+1]<<8|r[y+2]<<16)>>(7&n)&c)&p;if(w<(c=c-s-1)?(n+=l,y=w):(n+=l+1,p<y&&(y-=c)),a[++i]=--y,-1==y?(s+=y,b[--o]=i):s-=y,!y)for(;l=3&(r[l=n>>3]|r[l+1]<<8)>>(7&n),n+=2,i+=l,3==l;);}for((255<i||s)&&D(0),l=(e>>1)+(e>>3)+3,y=e-1,p=s=0;p<=i;++p)if((c=a[p])<1)u[p]=-c;else for(r=0;r<c;++r)for(b[s]=p;o<=(s=s+l&y););for(s&&D(0),r=0;r<e;++r)i=u[b[r]]++,o=f[r]=t-k(i),h[r]=(i<<o)-e;return[n+7>>3,{b:t,s:b,n:f,t:h}]}function I(r,t,e){var n=r.length,s=t.length,i=r[n-1],o=(1<<e.b)-1,f=-e.b;i||D(0);for(var a,u=0,h=e.b,n=(n<<3)-8+k(i)-h,i=-1;f<n&&i<s;)a=n>>3,t[++i]=e.s[u=(u<<h|(r[a]|r[1+a]<<8|r[2+a]<<16)>>(7&n))&o],n-=h=e.n[u];n==f&&i+1==s||D(0)}function h(r,t,e){var n,s=t.b,i=3&(f=r[s])>>1;t.l=1&f;var o=f>>3|r[s+1]<<5|r[s+2]<<13,f=(s+=3)+o;if(1==i)return s>=r.length?void 0:(t.b=s+1,e?(T(e,r[s],t.y,t.y+=o),e):T(new S(o),r[s]));if(!(f>r.length)){if(0==i)return t.b=f,e?(e.set(r.subarray(s,f),t.y),t.y+=o,e):E(r,s,f);if(2==i){o=3&(i=r[s])>>2;var a=i>>4,u=0,h=0;if((y=3&i)<2?1&o?a|=r[++s]<<4|(2&o&&r[++s]<<12):a=i>>3:u=(h=o)<2?(a|=(63&r[++s])<<4,r[s]>>6|r[++s]<<2):2==o?(a|=r[++s]<<4|(3&r[++s])<<12,r[s]>>2|r[++s]<<6):(a|=r[++s]<<4|(63&r[++s])<<12,r[s]>>6|r[++s]<<2|r[++s]<<10),++s,o=(i=e?e.subarray(t.y,t.y+t.m):new S(t.m)).length-a,0==y)i.set(r.subarray(s,s+=a),o);else if(1==y)T(i,r[s++],o);else{var l=t.h;if(2==y){var b,y=s,c=0,p=(l=-1,new S(292)),f=r[y],w=p.subarray(0,256),g=p.subarray(256,268),p=new x(p.buffer,268);if(f<128){c=(v=B(r,y+1,6))[1];var v=v[0]<<3;(A=r[y+=f])||D(0);for(var d=f=0,m=c.b,z=m,A=(++y<<3)-8+k(A);!((A-=m)<v||(n=A>>3,w[++l]=c.s[f+=(r[n]|r[1+n]<<8)>>(7&A)&(1<<m)-1],(A-=z)<v));)w[++l]=c.s[d+=(r[n=A>>3]|r[1+n]<<8)>>(7&A)&(1<<z)-1],m=c.n[f],f=c.t[f],z=c.n[d],d=c.t[d];255<++l&&D(0)}else{for(l=f-127;c<l;c+=2)v=r[++y],w[c]=v>>4,w[c+1]=15&v;++y}for(c=d=0;c<l;++c)11<(b=w[c])&&D(0),d+=b&&1<<b-1;for((c=(f=1<<(v=k(d)+1))-d)&c-1&&D(0),w[l++]=k(c)+1,c=0;c<l;++c)++g[w[c]=(b=w[c])&&v+1-b];for(b=(c=new S(f<<1)).subarray(0,f),d=c.subarray(f),p[v]=0,c=v;0<c;--c)T(d,c,m=p[c],p[c-1]=m+g[c]*(1<<v-c));for(p[0]!=f&&D(0),c=0;c<l;++c)(g=w[c])&&T(b,c,f=p[g],p[g]=f+(1<<v-g));u+=s-(s=(b=[y,{n:d,b:v,s:b}])[0]),t.h=l=b[1]}else l||D(0);(h?function(r,t,e){var n=6,s=t.length+3>>2,i=s<<1,o=s+i;I(r.subarray(6,n+=r[0]|r[1]<<8),t.subarray(0,s),e),I(r.subarray(n,n+=r[2]|r[3]<<8),t.subarray(s,i),e),I(r.subarray(n,n+=r[4]|r[5]<<8),t.subarray(i,o),e),I(r.subarray(n),t.subarray(o),e)}:I)(r.subarray(s,s+=u),i.subarray(o),l)}if(u=r[s++]){for(255==u?u=32512+(r[s++]|r[s++]<<8):127<u&&(u=u-128<<8|r[s++]),3&(a=r[s++])&&D(0),h=[M,U,F],g=2;-1<g;--g)1==(b=3&a>>2+(g<<1))?(b=new S([0,0,r[s++]]),h[g]={s:b.subarray(2,3),n:b.subarray(0,1),t:new x(b.buffer,0,1),b:0}):2==b?(s=(n=B(r,s,9-(1&g)))[0],h[g]="window size too large (>2046MB)"):3==b&&(t.t||D(0),h[g]=t.t[g]);for(n=(a=t.t=h)[0],s=a[1],a=a[2],(h=r[f-1])||D(0),y=0,l=(r[b=(h=(f<<3)-8+k(h)-a.b)>>3]|r[b+1]<<8)>>(7&h)&(1<<a.b)-1,w=(r[b=(h-=s.b)>>3]|r[b+1]<<8)>>(7&h)&(1<<s.b)-1,p=(r[b=(h-=n.b)>>3]|r[b+1]<<8)>>(7&h)&(1<<n.b)-1,++u;--u;){for(m=a.s[l],g=a.n[l],v=n.s[p],f=n.n[p],c=s.s[w],d=s.n[w],c=(z=1<<c)+((r[b=(h-=c)>>3]|r[b+1]<<8|r[b+2]<<16|r[b+3]<<24)>>>(7&h)&z-1),b=(h-=j[v])>>3,v=i[v]+((r[b]|r[b+1]<<8|r[b+2]<<16)>>(7&h)&(1<<j[v])-1),b=(h-=u[m])>>3,m=W[m]+((r[b]|r[b+1]<<8|r[b+2]<<16)>>(7&h)&(1<<u[m])-1),b=(h-=g)>>3,l=a.t[l]+((r[b]|r[b+1]<<8)>>(7&h)&(1<<g)-1),b=(h-=f)>>3,p=n.t[p]+((r[b]|r[b+1]<<8)>>(7&h)&(1<<f)-1),b=(h-=d)>>3,w=s.t[w]+((r[b]|r[b+1]<<8)>>(7&h)&(1<<d)-1),3<c?(t.o[2]=t.o[1],t.o[1]=t.o[0],t.o[0]=c-=3):(g=c-(0!=m))?(c=3==g?t.o[0]-1:t.o[g],1<g&&(t.o[2]=t.o[1]),t.o[1]=t.o[0],t.o[0]=c):c=t.o[0],g=0;g<m;++g)i[y+g]=i[o+g];if(o+=m,(f=(y+=m)-c)<0){for(c=-f,f=t.e+f,v<c&&(c=v),g=0;g<c;++g)i[y+g]=t.w[f+g];y+=c,v-=c,f=0}for(g=0;g<v;++g)i[y+g]=i[f+g];y+=v}if(y!=o)for(;o<i.length;)i[y++]=i[o++];else y=i.length;e?t.y+=y:i=E(i,0,y)}else if(e){if(t.y+=a,o)for(g=0;g<a;++g)i[g]=i[o+g]}else o&&(i=E(i,o));return t.b=f,i}D(2)}}function l(r,t){if(1==r.length)return r[0];for(var e,n=new S(t),s=0,i=0;s<r.length;++s)e=r[s],n.set(e,i),i+=e.length;return n}function r(r){this.ondata=r,this.c=[],this.z=this.l=0}var t={},g=ArrayBuffer,S=Uint8Array,x=Uint16Array,v=Int16Array,b=Int32Array;t.ZstdErrorCode={InvalidData:0,WindowSizeTooLarge:1,InvalidBlockType:2,FSEAccuracyTooHigh:3,DistanceTooFarBack:4,UnexpectedEOF:5};var D=function(r,t,e){if((t=Error(t||n[r])).code=r,Error.captureStackTrace&&Error.captureStackTrace(t,D),!e)throw t;return t},F=B(new S([81,16,99,140,49,198,24,99,12,33,196,24,99,102,102,134,70,146,4]),0,6)[1],M=B(new S([33,20,196,24,99,140,33,132,16,66,8,33,132,16,66,8,33,68,68,68,68,68,68,68,68,36,9]),0,6)[1],U=B(new S([32,132,16,66,102,70,68,68,68,68,36,73,2]),0,5)[1],e=function(r,t){for(var e=r.length,n=new b(e),s=0;s<e;++s)n[s]=t,t+=1<<r[s];return n},W=e(new S(new b([0,0,0,0,16843009,50528770,134678020,202050057,269422093]).buffer,0,36),0),j=new S(new b([0,0,0,0,0,0,0,0,16843009,50528770,117769220,185207048,252579084,16]).buffer,0,53);return e(j,3),t.decompress=function(r,t){for(var e,n=[],s=+!t,i=0;r.length;){if("object"==typeof(e=a(r,s||t))){for(s?(t=null,e.w.length==e.u&&(n.push(t=e.w),i+=e.u)):(n.push(t),e.e=0);!e.l;){var o=h(r,e,t);o||D(5),t?e.e=e.y:(n.push(o),i+=o.length,f(e.w,0,o.length),e.w.set(o,e.w.length-o.length))}e=e.b+4*e.c}r=r.subarray(e)}return l(n,i)},r.prototype.push=function(r,t){var e;if("number"==typeof this.s&&(e=Math.min(r.length,this.s),r=r.subarray(e),this.s-=e),e=r.length+this.l,!this.s){if(t){if(!e)return;e<5&&D(5)}else if(e<18)return this.c.push(r),void(this.l=e);if(this.l&&(this.c.push(r),r=l(this.c,e),this.c=[],this.l=0),"number"==typeof(this.s=a(r)))return this.push(r,t)}if("number"!=typeof this.s){if(e<(this.z||4)||(this.l&&(this.c.push(r),r=l(this.c,e),this.c=[],this.l=0),!this.z&&e<(this.z=2&r[this.s.b]?5:4+(r[this.s.b]>>3|r[this.s.b+1]<<5|r[this.s.b+2]<<13))))return t&&D(5),this.c.push(r),void(this.l=e);for(this.z=0;;){if(!(e=h(r,this.s)))return t&&D(5),e=r.subarray(this.s.b),this.s.b=0,this.c.push(e),void(this.l+=e.length);if(this.ondata(e,!1),f(this.s.w,0,e.length),this.s.w.set(e,this.s.w.length-e.length),this.s.l)return e=r.subarray(this.s.b),this.s=4*this.s.c,void this.push(e,t)}}},e=r,t.Decompress=e,t});